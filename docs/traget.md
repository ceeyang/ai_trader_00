# 多币种动态平衡量化交易系统 (PRD)

## 1. 项目概况 (Project Overview)
* **策略名称**: 高倍现货模拟策略 (Index-style Leveraged Long)
* **核心逻辑**: 通过持有一篮子（20个）优质山寨币，利用低倍实际杠杆（有效杠杆 2x）放大收益，并结合动态再平衡（Dynamic Rebalancing）进行高频波动收割。
* **目标环境**: Python 3.9+, CCXT 库, Binance 期货 API。

## 2. 交易参数设置 (Trading Parameters)
| 参数名称 | 参数值 | 说明 |
| :--- | :--- | :--- |
| **初始本金 (Equity)** | 200 USDT | 用于策略验证的初始保证金 |
| **币种数量 (N)** | 20 | 选定的山寨币数量 |
| **目标持仓价值 (Target Value)** | 20 USDT | 每个币种的名义价值 |
| **名义杠杆 (Leverage)** | 5x | 交易所下单时设置的杠杆倍数 |
| **实际杠杆 (Effective Leverage)** | 2x | (20 * 20) / 200，账户整体抗风险倍数 |
| **平衡阈值 (Threshold)** | 5% | 仓位偏离目标价值 5% 时触发再平衡 |
| **扫描周期 (Scan Interval)** | 5 min | 检查仓位价值并执行收割/补仓的频率 |
以上参数都可以动态配置

## 3. 核心功能模块 (Functional Modules)

### M1：市场自动扫描器 (Market Scanner)
* **任务**: 自动维护交易名单。
* **逻辑**: 
    1.  调用 `tradingview-screener` 获取 Binance 合约交易量 Top 50 的币种。
    2.  按板块分类（AI, MEME, L1/L2, RWA, DeFi），每个板块限制最大占比（如不超过 20%）。
    3.  剔除资金费率异常（年化 > 100%）或流动性极差的币种。

### M2：执行引擎 (Execution Engine)
* **任务**: 下单与保证金管理。
* **逻辑**:
    1.  统一设置为 `全仓模式 (Cross Margin)`。
    2.  下单前自动校验 `set_leverage(5)`。
    3.  计算下单量：`Quantity = TargetValue / CurrentPrice`。

### M3：动态收割/再平衡逻辑 (The Rebalancer)
* **逻辑流程**: 
    * **高抛 (Profit-Taking)**: 当单币价值 > `TargetValue * (1 + 5%)`，卖出超额部分。
    * **低吸 (Re-buying)**: 当单币价值 < `TargetValue * (1 - 5%)`，买入缺失部分。
    * **自动收网**: 这种方式能在不爆仓的情况下，把横盘震荡变成 U 本金收益。

### M4：风险控制 (Risk Management)
* **硬性止损**: 账户总 Equity 回撤超过 30% 时，系统自动一键清仓并停止运行。
* **异常监控**: 如果 API 返回余额不足，或单币价差过大（滑点保护），立即中止该笔交易。
* **资金费率**: 每 8 小时检查一次。若累计支付费率超过利润，触发告警。

## 4. 数据报表要求 (Data & Reporting)
* **实时 Dashboard**: 显示当前总资产、可用余额、各币种浮盈。
* **周报导出**: 
    * 各币种“贡献度” (Net Profit per Coin)。
    * 总资金费率损耗 (Total Funding Fees)。
    * 策略胜率与交易频次。

## 5. 开发任务清单 (Developer Tasks)
- [ ] 初始化 CCXT 交易所连接，配置 API Key。
- [ ] 编写 `get_top_symbols()` 扫描函数。
- [ ] 编写核心 `rebalance()` 函数循环检查持仓。
- [ ] 实现 Telegram Bot 消息推送功能（每 4 小时发送一次收益快报）。
- [ ] 编写 `CSV` 记录器，记录每一笔 Rebalance 的利润，用于生成周报。

---
**备注**: 开发时请务必使用测试网 (Testnet) 进行首轮验证。



### V2 MIND

策略 A: 主流币再平衡 (Mainstream Rebalancing)
核心逻辑: 相信价值回归。跌了买入（补仓），涨了卖出（止盈）。

标的: BTC, ETH, SOL, BNB 等大市值确定性资产。
操作: 设定固定仓位比例（如 BTC 20%）。BTC 跌了，比例变小，机器人买入。BTC 涨了，比例变大，机器人卖出。
维度	优势 (Pros)	劣势 (Cons)
市场表现	稳健。在震荡市（横盘）中表现最好，反复收割波动率。	收益有顶。不论牛市多疯，你总是在“卖飞”筹码。很难吃到百倍收益。
抗跌性	较好。因为选的是主流币，归零风险极低，大跌通常是买入机会。	接飞刀风险。如果遇到单边大熊市，会一路补仓被套住，虽然最终可能回本，但过程痛苦。
适用人群	资金量大、追求复利、厌恶归零风险的稳健型投资者。	想要“以小博大”、想要一夜暴富的资金不适合。
策略 B: 山寨币“搏金狗” (Altcoin Moonshot)
核心逻辑: 相信优胜劣汰。跌了卖出（止损），涨了持有（躺平）。

标的: 40+ 个中盘山寨币 (Meme, AI, GameFi 等板块)。
操作: 广撒网。如果不幸买到垃圾（跌30%），机器人砍仓离场。如果买到金狗（涨10倍），机器人持有不动让利润奔跑。
维度	优势 (Pros)	劣势 (Cons)
市场表现	爆发力极强。一旦押中一个 PEPE 或 ORDI，单币 10-100 倍的收益能覆盖所有止损。	磨损率高。在行情不好时，你会频繁止损，资金像“钝刀割肉”一样慢慢减少。
抗跌性	断尾求生。遇到暴跌直接空仓（止损了），保留本金火种。	踏空风险。如果刚好跌到 -31% 止损了，然后价格反转暴涨，你会非常难受（被洗下车）。
适用人群	资金量小、想要翻几十倍、能忍受本金回撤但不能接受归零的激进型投资者。	心理素质差、看到账户频繁止损会恐慌的人不适合。
核心区别：对“下跌”的处理
策略 A (再平衡): 下跌 = 机会。越跌越买，拉低均价。(Buy the Dip)
策略 B (搏金狗): 下跌 = 错误。跌了就跑，承认看走眼。(Cut Losses)